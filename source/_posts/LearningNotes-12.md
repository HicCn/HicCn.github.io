---
title: C# 泛型
tags: 编程
categories: 学习笔记
date: 2022-11-14 13:51:40
---
## 什么是类型参数
类型参数是实现泛型的重要手段，是指在定义泛型类或泛型方法时所使用的占位符，即用<code>"\<T>"</code>表示一个特定类型的参数
## 为什么需要泛型
引入参数类型我们可以实现一个可以延迟指定类型的类或方法，减少了强制类型转化的使用，提高了类型安全，避免了拆箱装箱的问题，增加了代码的可复用性。

## 泛型约束
基本用法：

|约束	|描述|
|---|---|
|where T : struct	|类型参数必须是不可为 null 的值类型。 有关可为 null 的值类型的信息，请参阅可为 null 的值类型。 由于所有值类型都具有可访问的无参数构造函数，因此 struct 约束表示 new() 约束，并且不能与 new() 约束结合使用。 struct 约束也不能与 unmanaged 约束结合使用。|
where T : class	| 类型参数必须是引用类型。 此约束还应用于任何类、接口、委托或数组类型。 在可为 null 的上下文中，T 必须是不可为 null 的引用类型。|
where T : class?	|类型参数必须是可为 null 或不可为 null 的引用类型。 此约束还应用于任何类、接口、委托或数组类型。|
where T : notnull	|类型参数必须是不可为 null 的类型。 参数可以是不可为 null 的引用类型，也可以是不可为 null 的值类型。|
where T : default	|重写方法或提供显式接口实现时，如果需要指定不受约束的类型参数，此约束可解决歧义。 default 约束表示基方法，但不包含 class 或 struct 约束。 有关详细信息，请参阅default约束规范建议。
where T : unmanaged|	类型参数必须是不可为 null 的非托管类型。 unmanaged 约束表示 struct 约束，且不能与 struct 约束或 new() 约束结合使用。|
where T : new()	|类型参数必须具有公共无参数构造函数。 与其他约束一起使用时，new() 约束必须最后指定。 new() 约束不能与 struct 和 unmanaged 约束结合使用。|
where T :<基类名>	|类型参数必须是指定的基类或派生自指定的基类。 在可为 null 的上下文中，T 必须是从指定基类派生的不可为 null 的引用类型。|
where T :<基类名>?	|类型参数必须是指定的基类或派生自指定的基类。 在可为 null 的上下文中，T 可以是从指定基类派生的可为 null 或不可为 null 的类型。|
where T :<接口名称>	|类型参数必须是指定的接口或实现指定的接口。 可指定多个接口约束。 约束接口也可以是泛型。 在的可为 null 的上下文中，T 必须是实现指定接口的不可为 null 的类型。|
where T :<接口名称>?	|类型参数必须是指定的接口或实现指定的接口。 可指定多个接口约束。 约束接口也可以是泛型。 在可为 null 的上下文中，T 可以是可为 null 的引用类型、不可为 null 的引用类型或值类型。 T 不能是可为 null 的值类型。|
where T : U	|为 T 提供的类型参数必须是为 U 提供的参数或派生自为 U 提供的参数。 在可为 null 的上下文中，如果 U 是不可为 null 的引用类型，T 必须是不可为 null 的引用类型。 如果 U 是可为 null 的引用类型，则 T 可以是可为 null 的引用类型，也可以是不可为 null 的引用类型。|

泛型约束可以同时约束多个条件。例如：

    class Base { }
    class Test<T, U>
        where U : struct
        where T : Base, new()
    { }
## 引申
- 对于引用类型的类型参数，泛型使用的是同一个方法表指针，而对于值类型则需要单独实现。